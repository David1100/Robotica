---
import { Icon } from "astro-icon/components";
import CartHome from "./CartHome";
const menuItems = [
  { label: "Programas", icon: "programs", href: "/programs" },
  { label: "Kits", icon: "kits", href: "/kits" },
  { label: "Accesorios", icon: "puzzle", href: "/accesorios" },
];

const currentPath = Astro.url.pathname;
---

<header
  id="site-header"
  class="fixed top-0 left-0 w-full py-2 z-50 transition-all"
>
  <div class="w-full flex justify-between items-center mx-auto max-w-7xl px-4">
    <!-- Logo -->
    <a href="/" class="hover:scale-105 transition-all flex items-center gap-2">
      <Icon name="logo" size={50} class={"text-bgPrimary animate-tada"} />
      <div class="flex-col drop-shadow-md hidden md:flex">
        <h1 class="text-4xl font-semibold">
          <span class="text-bgPrimary">C</span>apacitate
        </h1>
        <p class="text-xs text-black/50">Desata Tu Potencial Con Robótica</p>
      </div>
    </a>

    <!-- Menú Desktop -->
    <nav class="hidden md:flex">
      <ul class="flex gap-2">
        {
          menuItems.map((item) => (
            <a
              href={item.href}
              class={`flex gap-2 items-center hover:bg-gray-200/30 transition-all duration-300 p-4 rounded-xl border border-transparent group hover:text-bgPrimary drop-shadow-md  ${currentPath == item.href ? "text-bgPrimary bg-gray-200/10" : "text-gray-700"}`}
            >
              <Icon
                name={item.icon}
                size={22}
                class={"group-hover:text-bgPrimary transition-colors"}
              />
              {item.label}
            </a>
          ))
        }
      </ul>
    </nav>

    <!-- Botón usuario (desktop) -->
    <ul class="flex gap-2 items-center">
      <button
        class="hidden md:flex gap-2 items-center hover:bg-gray-200/30 transition-all duration-300 p-4 rounded-xl drop-shadow-md text-gray-700"
      >
        <div class="rounded-full bg-bgPrimary p-2">
          <img src="/icons/user.svg" width="16" alt="" />
        </div>
        Iniciar sesión
      </button>
      <CartHome client:load />
    </ul>

    <!-- Hamburguesa (mobile) -->
    <button
      id="menu-toggle"
      class="md:hidden p-3 rounded-xl hover:bg-gray-200/30"
    >
      <Icon name="menu" size={22} class={"text-bgPrimary"} />
    </button>
  </div>

  <!-- Menú Mobile -->
  <div
    id="mobile-menu"
    class="hidden flex-col gap-4 bg-white/90 backdrop-blur-md p-6 absolute top-full left-0 w-full md:hidden"
  >
    {
      menuItems.map((item) => (
        <a
          href={item.href}
          class="flex gap-2 items-center hover:bg-gray-600/10 transition-all duration-300 p-3 rounded-lg"
        >
          <img src={item.icon} width="22" alt="" />
          {item.label}
        </a>
      ))
    }

    <button
      class="flex gap-2 items-center hover:bg-gray-200/10 transition-all duration-300 p-3 rounded-lg"
    >
      <div class="rounded-full bg-bgPrimary p-2">
        <img src="/icons/user.svg" width="16" alt="" />
      </div>
      Iniciar sesión
    </button>
  </div>
</header>

<script>
  const header = document.getElementById("site-header");
  const menuToggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");

  // Cambiar fondo al hacer scroll
  window.addEventListener("scroll", () => {
    if (window.scrollY > 50) {
      header.classList.add("bg-white/60", "backdrop-blur-md", "shadow-md");
    } else {
      header.classList.remove("bg-white/60", "backdrop-blur-md", "shadow-md");
    }
  });

  // Toggle menú móvil
  menuToggle.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });
</script>
